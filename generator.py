
from sympy import isprime

prototype = '''
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000001111111111000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111000000000000000011111111111111111111111100000000000000111111111111111111111111111111111111111111111111111111111111111111111111
111111111111111111111111111111111111111111111111111111111111111111111100000000000000111111111111111111?111111111111111?0000000000000?1111111111111111111111111111111111111111111111111111111111111111111
111111111111111111111111111111111111111111111111111111111111111111000000000000011111111111111100000000000000011111111111111?000000000000?111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111000000000000011111111111110000000000000000000000000001111111111111000000000000011111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111000000000001111111111111000000000000000000000000000000000000011111111111100000000000011111111111111111111111111111111111111111111111111111111
111111111111111111111111111111111111111111111111111111100000000000011111111111?0000000000000000000000000000000000000000000001111111111110000000000011111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111110000000000011111111111000000000000000000000011111110000000000000000000000000111111111110000000000011111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111110000000000011111111110000000000000000000000000011100011100000001111111000000000000011111111111000000000011111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111000000000011111111110000000000000000001111000000011111111000000001100001100000000000000001111111111000000000011111111111111111111111111111111111111111111
111111111111111111111111111111111111111111110000000000111111111?0000000000000000000110000000000001100011101000011111000000000000000000000001111111111000000000011111111111111111111111111111111111111111
1111111111111111111111111111111111111111110000000001111111110000000000000000000000111000000110000111100111100011000111000000011100000000000000111111111?000000000111111111111111111111111111111111111111
111111111111111111111111111111111111111000000000011111111?000000000000000000000000?111000001100000000000000000111100000000011100011000000000000001111111110000000001111111111111111111111111111111111111
11111111111111111111111111111111111110000000001111111110000000000000011100000000000011111110000000000000000000000011000010001111001100000000000000001111111110000000001111111111111111111111111111111111
11111111111111111111111111111111111000000000111111110000000000000001110000000000000000000000000000000110000000000000000111000111000000111100000000000011111111100000000011111111111111111111111111111111
1111111111111111111111111111111110000000001111111100000000000000001100000000000000000000000000000?111111111110000000000000111111100000000111000000000000011111111000000000111111111111111111111111111111
11111111111111111111111111111110000000011111111?00000000000000000011000000011000000000000000011111111111111111111000000000000000000000111100111000000000000111111110000000001111111111111111111111111111
1111111111111111111111111111100000000?111111100000000000000011000001110000110000000000000011111111111111111111111111?00000000000001111110001100000000000000001111111100000000011111111111111111111111111
111111111111111111111111111000000000111111100000000000000000001100000111100000000000001111111111111111111111111111111111000000000000?1?00000000000000000000000011111111000000000111111111111111111111111
1111111111111111111111111?000000001111111000000000000001100000011100000000000000000111111111111111111000111111111111111111100000000000000000000000000000000000000?11111110000000011111111111111111111111
11111111111111111111111100000000111111100000000000000110001100000111000000000000111111111111111111111100111111111111111111111000000000000000000000001111000000000001111111100000000111111111111111111111
1111111111111111111111?00000001111111100000000000011110011100000000000000000011111111111111111111111000001111111111111111111111100000000000000000000000111000000000001111111?000000011111111111111111111
1111111111111111111110000000011111110000000000000110111110000000000000000011111111111111111111111111000000111111111111111111111111?000000000000000001111001100000000000111111100000000111111111111111111
1111111111111111111000000001111111?000000000001110000001111110000000000111111111111111111111111111111000000111111111111111?00111111110000000000011111000011000000000000011111111000000011111111111111111
11111111111111111100000000111111100000000000011111000000111000000000011111111111111111111111111111110000000111111111111100000001111111100000000000110000000000100000000000111111100000000111111111111111
111111111111111110000000?111111?0000000000000000111111000000000000?1111111111111111111111111111111110000000011111111111000000001111111111000000000000000000111111000000000011111110000000011111111111111
1111111111111111000000011111110000000000001110000000111000000000111111111111111111111111111111111110000000000111111?00000000000000?11111111000000000001111111?000110000000000111111?00000001111111111111
11111111111111?0000000111111100000000000110000011000000000000011111111111111111111111111111111111?00000000001111100000000000000000000111111110000000000?100001111110000000000011111110000000111111111111
111111111111100000000111111000000000000110000000010000000000?1111111111111111111111111111111111111110000000001100000000000000000000000011111111000000000001111?00000000000000001111111000000011111111111
11111111111100000001111111000000000000011100000011000000000111111111111111111111111111111111111111000000000000001?0000000000000000000000111111110000000000?111000000000000000000111111100000001111111111
111111111110000000111111100000000000000001111111100000000111111111111111111111111111?0001111111110000000000000111000000000000000000000001111111111000000000011111111111110000000011111110000000111111111
1111111111000000011111110000000000000000000000000000000011111111111111111111111111?000000000011100000000000000010000000000000000000000000000111111110000000000000110001100000000001111111000000011111111
11111111100000001111111000000000001111111111110000000011111111111111111111111111000000000000100000000000000000000010000000000000000000000000001111111000000000000011111000000000000111111100000001111111
11111111000000011111110000000000001110011001100000000111111111111110000?1111?000000000000000001000000000000000001110000000000000000000000000000001111100000000000001100000000000000011111110000000111111
11111111000000?11111100000000000000011110000000000001111111111110000000000000000000000000001000000000000000000010000000000000000000000000000000000011111000000000011000000001000000001111110000000111111
111111100000001111110000000000000000000111?0000000011111111110000000000000000000000000000000001000000000000000000010000000000000000000000000000000001111100000000011000111111100000000111111000000011111
1111110000000111111000000000001111110000010000000?1111111100000000000000000000000000000000011000000000000000000011000000000111111000000000?000000000011111000000000?111100000000000000?11111100000001111
11111?00000011111110000000000110001100000000000001111111000000000000000000000000001100?11100000000000000000000000111?00000111111111110000001110000000111111000000000010000000011000000011111100000001111
11111000000?1111110000000000011111110011000000001111110000000000000000000000000011110011?001110000000000000000000001111000000000111111000000011111?01111111100000000011011111111000000001111110000000111
1111000000011111100000000000110000011110000000011110000000000000000000000000000000000011111100000000000000000000000?111110000000000111111?000001111111111111100000000011?000000000000000111111?000000111
1111000000111111100000000000000000000110000000111100000000000000111?000000000000000011111100000000000000000000001111111111111000000001111111100000011111111111000000000100000000000000000111111000000011
111000000011111100000000000000000000000000000111111000000000111111?00000000000000111111111000000000000000000000001111111111?00000000000?1111111110000011111111100000000111110000000000000111111?00000011
1110000001111111000000000000000000000000000001111111000011111111000000001000000111100111000000000000000000000000000001111111?000000001111111111111111111111111100000000000000000000000000011111100000011
11000000011111100000000000000000000000000000111111111111111110000000001111111111000001111111100000000000000000000011111111111111110000011111111111111111111111110000000000000000000000000011111100000001
110000000111111000000000000000000000000000001111111111111110000000011111111111000001111111?0000000000000000000000001111111111111111100001111111111111111111111110000000000000000000000000011111110000001
10000000111111?000000000000000000000000000011111111111110000000?11111111100000000111111100000000000000000000000000000001111111111111111111111111111111111111111110000000000000000000000000?111111000000?
1000000011111100000000000000000000000000000111111111110000011111111111100000011111111000000000000000000000000000000011111111111111111111111111111111111111111111100000000000000000000000000111111000000?
10000000111111000000000000000000000000000011111111111111111111111111100001111111111110000000000000000000000000000000000111111111111111111111111111111111111111111?00000000000000000000000001111110000000
1000000?11111100000000000000000000000000001111111111111111111111111111111111111111111??11100000000000000000000000000000011111111111111111111111111111111111111111100000000000000000000000001111110000000
1000000111111?000000000000000000000000000011111111111111111111111111111111111111111111110000000000000000000000000000000001111111111111111111111111111111111111111100000000000000000000000001111110000000
10000001111110000000000000000000000000000011111111111111111111111111111111111111111100000000000000000000000000000000001111111111111111111111111111111111111111111100000000000000000000000001111110000000
10000001111110000000000000000000000000000111111111111111111111111111111111111111111111110000000000000000000000000000000?01111111111111111111111111111111111111111100000000000000000000000001111110000000
10000001111110000000000000000000000000000111111111111111111111111111111111111111111110000000000001110000111100000000011111011111111111111111111111111111111111111100000000000000000000000001111110000000
10000001111110000000000000000000000000000111111111111111111111111111111111111111111001111111111111110000111111111111111111111111111111111111111111111111111111110000000000000000000000000001111110000000
10000001111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111110000111111111111111111111111111111111111111111111111111100000000000000000000000000000001111110000000
1000000111111?00000000000000000000000000000000000?11111111111111111111111111111111111111111111111111000011111111111111111111111111111111111111111111111100000000000000000000000000000000000111111000000?
1000000?1111110000000000000000000100000000000000000000011111111111111111111111111111111111111111111100000111111111111111111111111111111111111111111000000000000000000001100000000000000000?1111110000001
100000001111110000000000000000001110000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111?00000000000000000000011000011011000000000000111111?0000001
10000000111111000000000000000111001001110000000000000000000000000000?11111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000110000110000000000000011111100000001
1?000000111111?00000000000000000001110000111000000000000000000000000000000000011111111111111111111111111111111111111111111111100000000000000000000000000000000111100011000000000000000000?11111100000011
110000000111111000000000000000000000011110010011000000000000000000000000000000000000000000000?1111111111111111?00000000000000000000000000000000000000001110000110011000000000000000000001111111000000011
11000000011111110000000000000000000000000111000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001110010000011000000000000000000001111111110000000111
1110000000111111111?000000000000000000000001000110110011000111000000000000000000000000000000000000000000000000000000000000000000001110000000111111100011101110000000000000000000001111111111000000000111
11110000000001111111111000000000000000000000001100000110010000010011100010000000000000000000000000000000000000111100000000001110010000000000000110000011000000000000000000000001111111111000000000111111
11111100000000001111111111100000000000000000000000000110011000110010110110000110000110000000000111100011110001000000110001100100100000000000000011000000000000000000000000001111111111000000000011111111
11111111?00000000001111111111110000000000000000000000000000011000110011100011011000100000000001000000110000001111000101001000100010000100000000000000000000000000000000011111111111000000000011111111111
11111111111100000000000111111111111000000000000000000000000000000000001001110011001100000000000011100110000001000000100101000100001110000000000000000000000000000000111111111110000000000011111111111111
11111111111111100000000000011111111111110000000000000000000000000000000000000000001111100000010000100011110001111000100011001110000000000000000000000000000000011111111111100000000000011111111111111111
1111111111111111111000000000000?1111111111111?0000000000000000000000000000000000000000000000001111000000000000000000000000000000000000000000000000000000001111111111111?00000000000011111111111111111111
11111111111111111111111000000000000011111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111110000000000000111111111111111111111111
11111111111111111111111111100000000000000011111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111000000000000001111111111111111111111111111
11111111111111111111111111111111000000000000000011111111111111111111?00000000000000000000000000000000000000000000000000000000000000?11111111111111111111000000000000000111111111111111111111111111111111
111111111111111111111111111111111111100000000000000000?1111111111111111111111111?00000000000000000000000000000000000000?11111111111111111111111111000000000000000001111111111111111111111111111111111111
111111111111111111111111111111111111111111?0000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111?00000000000000000001111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111110000000000000000000000000?11111111111111111111111111111111111111111111111111100000000000000000000000001111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111?00000000000000000000000000000000000011111111111111000000000000000000000000000000000000?11111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111?00000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111
1111111111111111111111111111111111111111111111111111111111111111111111111111111?000000000000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111
'''


def next_test( source ):

	slots = [ i for i, c in enumerate(source) if c == '?' ]

	source = list( source )

	for test in range( 1<<len(slots) ):

		test_b = bin(test)[2:].zfill( len(slots) )

		for bit, pos in enumerate( slots ):

			source[pos] = test_b[bit]

		yield ''.join( source )



def sanity_check( n, i=100 ):

	def euclids_gcd(a, b):

	    if b > a:
	        a, b = b, a

	    if a % b == 0:
	        return b

	    return euclids_gcd (b, a % b)

	def miller_rabin ( n, a ): # True implies n is composite

		# Test if n is even
		if not( n & 1 ):
			return True

		# Test if a divides n
		gcd = euclids_gcd( n, a )

		if (1 < gcd ) and ( gcd < n ):
			return True

		# Find q such that n - 1 = 2^k q

		q = n - 1
		k = 0
		while not( q & 1 ):
			q >>= 1
			k  += 1

		# Search for the existence of i such that a^( (2^i) q ) = -1 (mod p), i < k
		a = pow( a, q, n )

		if a == 1:
			return False

		for i in range( k ):

			if a == n-1:

				return False

			a = pow( a, 2, n )

		return True

	for a in range( 1, i+2 ):

		if miller_rabin( n, a ):

			return False

	return True




if __name__ == '__main__':

	tries = 0

	for test in next_test( prototype ):

		tries += 1

		as_int = int( ''.join(test.split()), 2 )

		if isprime( as_int ):

			if sanity_check( as_int ):
				print(as_int)
				break

			else:
				print( "Something's odd... sanity check failed")

			print('\nTries: ', tries)
